# Backtesting

Backtesing framework written in C++17 to simulate trading strategy for BTC/USD pair.

#### DISCLAIMER âš ï¸ğŸ›‘

THIS FRAMEWORK IS NOT INTENDED FOR ANY REAL-WORLD INVESTMENT DECISIONS. THE USE OF THIS FRAMEWORK AND THE DATA PROVIDED IS AT YOUR OWN RISK. I DO NOT TAKE ANY RESPONSIBILITY FOR THE CORRECTNESS OF THE DATA OR ANY OUTPUTS GENERATED BY THIS FRAMEWORK WHEN APPLIED IN REAL-WORLD SCENARIOS. THIS FRAMEWORK IS DESIGNED SOLELY FOR LEARNING AND EDUCATIONAL PURPOSES.

- [Dependency](#dependency)
- [Project Structure](#project-structure)
- [Data Download](#data)
- [Compiling & Building](#compiling)
- [Tick Data Generation](#input)
- [How to Run](#run)
- [Optimization levels](#levels)
- [Eureka Found ğŸ¤¯](#eureka-ğŸ¤¯)
- [License](#license)

#### Dependency

[common-util](https://github.com/xpd54/common_util) added as git submodule.
[gnu plot](http://www.gnuplot.info/) On mac easy installation would be `brew install gnuplot`
C++17, CMake, LLVM

#### Project-Structure

```
â”œâ”€â”€ backtesting
â”‚Â Â  â”œâ”€â”€ base (This compiles as static lib which get used in both data generation and simulation)
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ account (Keep track of account balance/simulate buy and sell)
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ common_interface
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ price_history (OHLC data clean up)
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ trade_simulator (Interface to add new trade strategy)
â”‚Â Â  â”‚Â Â  â””â”€â”€ util (Read/Write into binary file, getting cmd line argument)
â”‚Â Â  â”œâ”€â”€ execution (actually running the simulation)
â”‚Â Â  â”œâ”€â”€ logs (log generation which get used to plot a graph)
â”‚Â Â  â””â”€â”€ simulators (Trading strategy and Trade Simulator logic)
â”‚Â Â      â””â”€â”€ strategy
â”œâ”€â”€ data (Create this folder to hold ohlc data)
â”œâ”€â”€ data_generator (Logic to convert TPV to OHLC and change frequency of OHLC)
â”œâ”€â”€ external (Added dependancy as git submodule, memory map file, logger, time, command line argument and string formate util)
â”œâ”€â”€ quick_run (bash script to quickly running the project)
â””â”€â”€ result_plot (logic to plot a graph after running simulation)
```

Data [LINK](https://www.kaggle.com/api/v1/datasets/download/saltwateroil/bitstamp-tpv-usd)

Convert csv to binary

```
./ohlc_generator \
--input_price_history_csv_file="../data/bitstamp_tick_data.csv" \
--output_price_history_binary_file="../data/bitstamp_tick_data.mov" \
--start_time="2017-01-01" \
--end_time="2024-01-01"
```

Convert TPV to OHLC with 5 min frequency rate

```
./ohlc_generator \
--input_price_history_binary_file="../data/bitstamp_tick_data.mov" \
--output_ohlc_history_binary_file="../data/bitstamp_tick_data_5min.mov" \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--interval_rate_sec=300
```

Convert TPV to OHLC with 5 min frequency rate

```
./ohlc_generator \
--input_price_history_binary_file="../data/bitstamp_tick_data.mov" \
--output_ohlc_history_binary_file="../data/bitstamp_tick_data_30min.mov" \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--interval_rate_sec=300
```

Convert TPV to OHLC with 1h frequency rate

```
./ohlc_generator \
--input_price_history_binary_file="../data/bitstamp_tick_data.mov" \
--output_ohlc_history_binary_file="../data/bitstamp_tick_data_1h.mov" \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--interval_rate_sec=3600
```

Run Trade Simulation on 5 min frequency

```
./trade_simulator \
--input_price_history_binary_file="../data/bitstamp_tick_data_5min.mov" \
--output_account_log_file="../data/account.log" \
--output_simulator_log_file="../data/simulator.log" \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--start_base_balance=1.0 \
--start_quote_balance=0.0
```

Run Trade Simulation on 30 min frequency

```
./trade_simulator \
--input_price_history_binary_file="../data/bitstamp_tick_data_30min.mov" \
--output_account_log_file="../data/account.log" \
--output_simulator_log_file="../data/simulator.log" \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--start_base_balance=1.0 \
--start_quote_balance=0.0
```

Run Trade Simulation on 1 hour frequency

```
./trade_simulator \
--input_price_history_binary_file="../data/bitstamp_tick_data_1h.mov" \
--output_account_log_file="../data/account.log" \
--output_simulator_log_file="../data/simulator.log" \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--start_base_balance=1.0 \
--start_quote_balance=0.0
```

Run Trade Simulation on 1 hour frequency for multiple 6 month period

```
./trade_simulator \
--input_price_history_binary_file="../data/bitstamp_tick_data_1h.mov" \
--output_account_log_file="../data/account.log" \
--output_simulator_log_file="../data/simulator.log" \
--evaluation_period_months=6 \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--start_base_balance=1.0 \
--start_quote_balance=0.0
```

Run Trade Simulation on 1 hour frequency for multiple 6 month period with all combination
(Getting best alpha and epsiolon sorted with score)

```
./trade_simulator \
--input_price_history_binary_file="../data/bitstamp_tick_data_1h.mov" \
--output_account_log_file="../data/account.log" \
--output_simulator_log_file="../data/simulator.log" \
--evaluation_period_months=6 \
--start_time="2017-01-01" \
--end_time="2024-01-01" \
--start_base_balance=1.0 \
--start_quote_balance=0.0 \
--evaluate_combination=1
```

```
./plot --output_account_log_file="../data/account.log"
```
